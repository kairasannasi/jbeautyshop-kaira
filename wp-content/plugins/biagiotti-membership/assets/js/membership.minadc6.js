var facebookAppId;!function(e,o,a){var t=e.getElementsByTagName(o)[0];e.getElementById(a)||((o=e.createElement(o)).id=a,o.src="//connect.facebook.net/en_US/sdk.js",t.parentNode.insertBefore(o,t))}(document,"script","facebook-jssdk"),(facebookAppId="undefined"!=typeof mkdfSocialLoginVars?mkdfSocialLoginVars.social.facebookAppId:facebookAppId)&&(window.fbAsyncInit=function(){FB.init({appId:facebookAppId,cookie:!0,xfbml:!0,version:"v2.5"}),window.FB=FB}),function(n){"use strict";var e={};function o(){var e=n(".mkdf-modal-opener"),a=n(".mkdf-modal-holder"),t=n(".mkdf-login-popup-close-btn");e.length&&a.length&&(e.on("click",function(e){e.preventDefault();var o=n(this).data("modal");a.fadeOut(300),a.removeClass("opened"),a.each(function(){var e=n(this);"undefined"!==e.data("modal")&&e.data("modal")===o&&(e.fadeIn(300),e.addClass("opened"))})}),a.each(function(){var o=n(this);o.on("click",function(e){o.hasClass("opened")&&(o.fadeOut(300),o.removeClass("opened"))}),t.on("click",function(e){o.hasClass("opened")&&(o.fadeOut(300),o.removeClass("opened"))}),n(window).on("keyup",function(e){o.hasClass("opened")&&27===e.keyCode&&(o.fadeOut(300),o.removeClass("opened"))}),o.find(".mkdf-modal-content").on("click",function(e){e.stopPropagation()})}))}function a(){n(".mkdf-login-form").on("submit",function(e){e.preventDefault();e={action:"biagiotti_membership_login_user",security:n(this).find("#mkdf-login-security").val(),login_data:n(this).serialize()};return n.ajax({type:"POST",data:e,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){e=JSON.parse(e);s(e),"success"===e.status&&(window.location=e.redirect)}}),!1})}function t(){n(".mkdf-register-form").on("submit",function(e){e.preventDefault();e={action:"biagiotti_membership_register_user",security:n(this).find("#mkdf-register-security").val(),register_data:n(this).serialize()};return n.ajax({type:"POST",data:e,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){e=JSON.parse(e);s(e),"success"===e.status&&(window.location=e.redirect)}}),!1})}function i(){var o=n(".mkdf-reset-pass-form");o.on("submit",function(e){e.preventDefault();e={action:"biagiotti_membership_user_lost_password",user_login:o.find("#user_reset_password_login").val()};n.ajax({type:"POST",data:e,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){e=JSON.parse(e);s(e),"success"===e.status&&(window.location=e.redirect)}})})}function s(e){var o=n(".mkdf-membership-response-holder"),a=_.template(n(".mkdf-membership-response-template").html()),t="success"===e.status?"mkdf-membership-message-succes":"mkdf-membership-message-error",e=a({messageClass:t,message:e.message});o.html(e)}function d(){n(".mkdf-facebook-login-holder").on("submit",function(e){e.preventDefault(),window.FB.login(function(e){"connected"===(e=e).status?(console.log("Welcome! Fetching information from Facebook..."),FB.api("/me","GET",{fields:"id, name, email, link, picture"},function(e){var o=n(".mkdf-facebook-login-holder [name^=mkdf_nonce_facebook_login]").val();e.nonce=o,e.image=e.picture.data.url;e={action:"biagiotti_membership_check_facebook_user",response:e};n.ajax({type:"POST",data:e,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){e=JSON.parse(e);s(e),"success"===e.status&&(window.location=e.redirect)}})})):"not_authorized"===e.status?console.log("Please log into this app"):console.log("Please log into Facebook")},{scope:"email, public_profile"})})}function r(){var e;(e="undefined"!=typeof mkdfSocialLoginVars?mkdfSocialLoginVars.social.googleClientId:e)?gapi.load("auth2",function(){window.auth2=gapi.auth2.init({client_id:e}),n(".mkdf-google-login-holder").on("submit",function(e){var o;e.preventDefault(),window.auth2.signIn(),window.auth2.isSignedIn.get()&&(o=window.auth2.currentUser.get().getBasicProfile(),e=n(".mkdf-google-login-holder [name^=mkdf_nonce_google_login]").val(),e={action:"biagiotti_membership_check_google_user",response:{id:o.getId(),name:o.getName(),email:o.getEmail(),image:o.getImageUrl(),link:"https://plus.google.com/"+o.getId(),nonce:e}},n.ajax({type:"POST",data:e,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){e=JSON.parse(e);s(e),"success"===e.status&&(window.location=e.redirect)}}))})}):n(".mkdf-google-login-holder").on("submit",function(e){e.preventDefault()})}"undefined"!=typeof mkdf&&(mkdf.modules.socialLogin=e),e.mkdfUserLogin=a,e.mkdfUserRegister=t,e.mkdfUserLostPassword=i,e.mkdfInitWidgetModal=o,e.mkdfInitFacebookLogin=d,e.mkdfInitGooglePlusLogin=r,e.mkdfRenderAjaxResponseMessage=s,n(document).ready(function(){o(),a(),t(),i(),function(){var e=n(".mkdf-login-tabs");e.length&&e.each(function(){var e=n(this);e.children(".mkdf-tab-container").each(function(e){e+=1;var o=n(this),a=o.attr("id"),o=o.parent().find(".mkdf-tabs-nav li:nth-child("+e+") a"),e=o.attr("href");-1<(a="#"+a).indexOf(e)&&o.attr("href",a)}),e.tabs(),n(".mkdf-login-tabs a.mkdf-external-link").unbind("click")})}()}),n(window).on("load",function(){d(),r(),function(){n(".mkdf-membership-main-wrapper");var e=n(".page-template-user-dashboard .mkdf-content"),o=n(".mkdf-page-footer"),a=0;!mkdf.body.hasClass("mkdf-header-transparent")&&1024<mkdf.windowWidth&&(a=a+mkdfGlobalVars.vars.mkdfMenuAreaHeight+mkdfGlobalVars.vars.mkdfLogoAreaHeight),0<o.length&&(a+=o.outerHeight()),1024<mkdf.windowWidth&&(a=mkdf.windowHeight-a,e.css({"min-height":a+"px"}))}()})}(jQuery),function(t){"use strict";var e={};function o(){a(),t(document.body).on("biagiotti_membership_favorites_trigger",function(){a()})}function a(){t(".mkdf-membership-item-favorites").on("click",function(e){e.preventDefault();var o,a,e=t(this);void 0!==e.data("item-id")&&(a=e.data("item-id")),o=e,a={action:"biagiotti_membership_add_item_to_favorites",item_id:a=a},t.ajax({type:"POST",data:a,url:mkdfGlobalVars.vars.mkdfAjaxUrl,success:function(e){e=JSON.parse(e);"success"===e.status&&(o.hasClass("mkdf-icon-only")||o.find("span").text(e.data.message),o.find(".mkdf-favorites-icon").removeClass("mkdf-favorite-inactive mkdf-favorite-active").addClass(e.data.icon))}})})}(mkdf.modules.membershipFavorites=e).mkdfOnDocumentReady=o,t(document).ready(o)}(jQuery);